(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{4182:function(e,t,s){Promise.resolve().then(s.bind(s,4723))},4723:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return a}});var n=s(7437),r=s(2265),o=s(1774),i=s(2141),u=s(7648);function a(){let e=(0,o.useUser)(),[t,s]=(0,r.useState)([]),[a,l]=(0,r.useState)("");(0,r.useEffect)(()=>{e&&(async()=>{let{data:t}=await i.O.rpc("get_user_conversations",{user_id:e.id});s(t||[])})()},[e]);let c=(0,r.useMemo)(()=>{let e=a.toLowerCase();return t.filter(t=>{var s,n,r;return(null===(s=t.username)||void 0===s?void 0:s.toLowerCase().includes(e))||(null===(n=t.nombre)||void 0===n?void 0:n.toLowerCase().includes(e))||(null===(r=t.last_message)||void 0===r?void 0:r.toLowerCase().includes(e))})},[t,a]);return(0,n.jsxs)("div",{className:"min-h-screen bg-[#DFF6EA] p-4 max-w-3xl mx-auto",children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-[#5cae97] mb-4",children:"Bandeja de entrada"}),(0,n.jsx)("input",{type:"text",value:a,onChange:e=>l(e.target.value),placeholder:"Buscar por usuario, nombre o mensaje...",className:"w-full mb-6 px-4 py-2 border rounded-xl shadow-sm"}),0===c.length?(0,n.jsx)("p",{className:"text-gray-500",children:"No tienes conversaciones activas."}):(0,n.jsx)("div",{className:"space-y-4",children:c.map(e=>(0,n.jsxs)(u.default,{href:"/chat/".concat(e.username),className:"flex items-center justify-between bg-white rounded-xl shadow p-4 hover:bg-gray-50",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"text-sm text-gray-700 font-medium",children:["@",e.username]}),e.nombre&&(0,n.jsx)("p",{className:"text-xs text-gray-500",children:e.nombre}),(0,n.jsx)("p",{className:"text-xs text-gray-400",children:e.last_message})]}),e.unread_count>0&&(0,n.jsx)("div",{className:"bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full",children:e.unread_count})]},e.username))})]})}},2141:function(e,t,s){"use strict";s.d(t,{O:function(){return n}});let n=(0,s(6580).eI)("https://cinsudwupbiqqizvqwij.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNpbnN1ZHd1cGJpcXFpenZxd2lqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0ODQ3MTIsImV4cCI6MjA2ODA2MDcxMn0.NL4RoZ3dPWllHaJfK37WtPtu-6NTNJ-DRJrs6MAY8E0")},1774:function(e,t,s){"use strict";var n=Object.defineProperty,r=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,u=(e,t,s)=>new Promise((n,r)=>{var o=e=>{try{u(s.next(e))}catch(e){r(e)}},i=e=>{try{u(s.throw(e))}catch(e){r(e)}},u=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,i);u((s=s.apply(e,t)).next())}),a={};((e,t)=>{for(var s in t)n(e,s,{get:t[s],enumerable:!0})})(a,{SessionContextProvider:()=>x,useSession:()=>h,useSessionContext:()=>m,useSupabaseClient:()=>f,useUser:()=>p}),e.exports=((e,t,s,u)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of o(t))i.call(e,s)||void 0===s||n(e,s,{get:()=>t[s],enumerable:!(u=r(t,s))||u.enumerable});return e})(n({},"__esModule",{value:!0}),a);var l=s(2265),c=s(7437),d=(0,l.createContext)({isLoading:!0,session:null,error:null,supabaseClient:{}}),x=({supabaseClient:e,initialSession:t=null,children:s})=>{let[n,r]=(0,l.useState)(t),[o,i]=(0,l.useState)(!t),[a,x]=(0,l.useState)();(0,l.useEffect)(()=>{!n&&t&&r(t)},[n,t]),(0,l.useEffect)(()=>{let t=!0;return function(){u(this,null,function*(){let{data:{session:s},error:n}=yield e.auth.getSession();if(t){if(n){x(n),i(!1);return}r(s),i(!1)}})}(),()=>{t=!1}},[]),(0,l.useEffect)(()=>{let{data:{subscription:t}}=e.auth.onAuthStateChange((e,t)=>{t&&("SIGNED_IN"===e||"TOKEN_REFRESHED"===e||"USER_UPDATED"===e)&&r(t),"SIGNED_OUT"===e&&r(null)});return()=>{t.unsubscribe()}},[]);let m=(0,l.useMemo)(()=>o?{isLoading:!0,session:null,error:null,supabaseClient:e}:a?{isLoading:!1,session:null,error:a,supabaseClient:e}:{isLoading:!1,session:n,error:null,supabaseClient:e},[o,n,a]);return(0,c.jsx)(d.Provider,{value:m,children:s})},m=()=>{let e=(0,l.useContext)(d);if(void 0===e)throw Error("useSessionContext must be used within a SessionContextProvider.");return e};function f(){let e=(0,l.useContext)(d);if(void 0===e)throw Error("useSupabaseClient must be used within a SessionContextProvider.");return e.supabaseClient}var h=()=>{let e=(0,l.useContext)(d);if(void 0===e)throw Error("useSession must be used within a SessionContextProvider.");return e.session},p=()=>{var e,t;let s=(0,l.useContext)(d);if(void 0===s)throw Error("useUser must be used within a SessionContextProvider.");return null!=(t=null==(e=s.session)?void 0:e.user)?t:null}}},function(e){e.O(0,[648,580,971,117,744],function(){return e(e.s=4182)}),_N_E=e.O()}]);