(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[330],{4827:function(e,a,r){Promise.resolve().then(r.bind(r,7745))},7745:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return h}});var o=r(7437),t=r(2265),l=r(1774),n=r(9376),i=r(2141),s=r(9064),u=r(7648);let c=["\xc1lava","Albacete","Alicante","Almer\xeda","Asturias","\xc1vila","Badajoz","Barcelona","Burgos","C\xe1ceres","C\xe1diz","Cantabria","Castell\xf3n","Ciudad Real","C\xf3rdoba","Cuenca","Gerona","Granada","Guadalajara","Guip\xfazcoa","Huelva","Huesca","Islas Baleares","Ja\xe9n","La Coru\xf1a","La Rioja","Las Palmas","Le\xf3n","L\xe9rida","Lugo","Madrid","M\xe1laga","Murcia","Navarra","Orense","Palencia","Pontevedra","Salamanca","Santa Cruz de Tenerife","Segovia","Sevilla","Soria","Tarragona","Teruel","Toledo","Valencia","Valladolid","Vizcaya","Zamora","Zaragoza"],d=["Affenpinscher","Akita Inu","Alaskan Malamute","American Bully","American Pit Bull Terrier","Basenji","Basset Hound","Beagle","Beauceron","Bedlington Terrier","Bich\xf3n Fris\xe9","Bich\xf3n Malt\xe9s","Bobtail","Border Collie","B\xf3xer","Braco Alem\xe1n","Braco de Weimar","Bulldog Franc\xe9s","Bulldog Ingl\xe9s","Bullmastiff","Cairn Terrier","Cane Corso","Caniche","Carlino (Pug)","Cavalier King Charles Spaniel","Chihuahua","Chow Chow","Cocker Spaniel Americano","Cocker Spaniel Ingl\xe9s","Collie","D\xe1lmata","Dogo Alem\xe1n","Dogo Argentino","Dogo de Burdeos","Doberman","Epagneul Bret\xf3n","Fox Terrier","Galgo Espa\xf1ol","Golden Retriever","Gran Dan\xe9s","Greyhound","Husky Siberiano","Jack Russell Terrier","Keeshond","Labrador Retriever","Lhasa Apso","Mast\xedn Espa\xf1ol","Mast\xedn Napolitano","Papill\xf3n","Pastor Alem\xe1n","Pastor Australiano","Pastor Belga","Pastor Blanco Suizo","Pequin\xe9s","Perro de Agua Espa\xf1ol","Pinscher Miniatura","Pointer","Pomerania","Rottweiler","Salchicha (Teckel)","Samoyedo","San Bernardo","Scottish Terrier","Setter Irland\xe9s","Shar Pei","Shiba Inu","Shih Tzu","Staffordshire Bull Terrier","Terranova","Vizsla","West Highland White Terrier","Whippet","Yorkshire Terrier"],p=["Abisinio","American Curl","Angora Turco","Azul Ruso","Balines","Bengal\xed","Bobtail Japon\xe9s","Bombay","Bosque de Noruega","Brit\xe1nico de Pelo Corto","Burm\xe9s","Cartujo (Chartreux)","Cornish Rex","Devon Rex","Egipcio (Mau Egipcio)","Europeo Com\xfan","Ex\xf3tico de Pelo Corto","Fold Escoc\xe9s","Himalayo","Korat","LaPerm","Maine Coon","Manx","Mau Egipcio","Munchkin","Nebelung","Ocicat","Oriental","Persa","Peterbald","Ragdoll","Savannah","Scottish Fold","Selkirk Rex","Siam\xe9s","Siberiano","Singapura","Snowshoe","Sphynx","Tonkin\xe9s","Toyger","Van Turco"];function h(){let e=(0,l.useUser)(),a=(0,n.useRouter)(),[r,h]=(0,t.useState)(""),[g,f]=(0,t.useState)(""),[m,v]=(0,t.useState)(""),[x,b]=(0,t.useState)(""),[S,C]=(0,t.useState)(""),[j,w]=(0,t.useState)(""),[P,y]=(0,t.useState)(""),[N,B]=(0,t.useState)(""),[E,A]=(0,t.useState)(!1),[I,T]=(0,t.useState)(null),[O,_]=(0,t.useState)(null),[z,k]=(0,t.useState)(null),[M,D]=(0,t.useState)(!1);(0,t.useEffect)(()=>{e&&(async()=>{let{data:a,error:r}=await i.O.from("profiles").select("*").eq("id",e.id).single();if(r||!a){s.ZP.error("Error al cargar perfil");return}h(a.username||""),f(a.nombre||""),v(a.telefono||""),b(a.provincia||""),C(a.afijo||""),w(a.nucleo_zoologico||""),y(a.tipo_animal||""),B(a.raza_criada||""),A(a.is_criadero||!1),a.avatar_url&&(_(a.avatar_url),k("https://cinsudwupbiqqizvqwij.supabase.co/storage/v1/object/public/avatars/".concat(a.avatar_url)))})()},[e]);let R=async o=>{if(o.preventDefault(),e){D(!0);try{let o=O;if(I){let a=I.name.split(".").pop(),r="".concat(e.id,"/").concat(Date.now(),".").concat(a),{error:t}=await i.O.storage.from("avatars").upload(r,I,{upsert:!0});if(t){s.ZP.error("No se pudo subir el avatar"),D(!1);return}o=r}let{error:t}=await i.O.from("profiles").update({username:r,nombre:g,telefono:m,provincia:x,afijo:E?S:null,nucleo_zoologico:E?j:null,tipo_animal:E?P:null,raza_criada:E?N:null,is_criadero:E,avatar_url:o||null}).eq("id",e.id);if(t){s.ZP.error("No se pudieron guardar los cambios"),D(!1);return}s.ZP.success("Perfil actualizado"),a.push("/mi-perfil")}catch(e){console.error(e),s.ZP.error("Error inesperado")}finally{D(!1)}}};return(0,o.jsxs)("div",{className:"min-h-screen bg-[#DFF6EA] flex flex-col items-center justify-center px-4 py-10",children:[(0,o.jsx)("img",{src:"/logo-criador.png",alt:"Logo",className:"w-20 h-20 mb-6"}),(0,o.jsxs)("form",{onSubmit:R,className:"bg-white w-full max-w-md p-6 rounded-3xl shadow-xl space-y-4",children:[(0,o.jsx)("h1",{className:"text-xl font-bold text-center text-[#5cae97]",children:"Editar perfil"}),(0,o.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var a;let r=null===(a=e.target.files)||void 0===a?void 0:a[0];r&&(T(r),k(URL.createObjectURL(r)))}}),z&&(0,o.jsx)("img",{src:z,alt:"Vista previa",className:"w-[100px] h-[100px] rounded-full border object-cover mx-auto"}),(0,o.jsx)("input",{value:r,onChange:e=>h(e.target.value),placeholder:"Usuario",className:"w-full border px-4 py-2 rounded-lg"}),(0,o.jsx)("input",{value:g,onChange:e=>f(e.target.value),placeholder:"Nombre",className:"w-full border px-4 py-2 rounded-lg"}),(0,o.jsx)("input",{value:m,onChange:e=>v(e.target.value),placeholder:"Tel\xe9fono",className:"w-full border px-4 py-2 rounded-lg"}),(0,o.jsxs)("select",{value:x,onChange:e=>b(e.target.value),className:"w-full border px-4 py-2 rounded-lg",children:[(0,o.jsx)("option",{value:"",children:"Selecciona tu provincia"}),c.map(e=>(0,o.jsx)("option",{value:e,children:e},e))]}),(0,o.jsxs)("label",{className:"flex items-center gap-2",children:[(0,o.jsx)("input",{type:"checkbox",checked:E,onChange:e=>A(e.target.checked)}),"Soy criadero"]}),E&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("input",{value:S,onChange:e=>C(e.target.value),placeholder:"Afijo",className:"w-full border px-4 py-2 rounded-lg"}),(0,o.jsx)("input",{value:j,onChange:e=>w(e.target.value),placeholder:"N\xfacleo zool\xf3gico",className:"w-full border px-4 py-2 rounded-lg"}),(0,o.jsxs)("select",{value:P,onChange:e=>{y(e.target.value),B("")},className:"w-full border px-4 py-2 rounded-lg",children:[(0,o.jsx)("option",{value:"",children:"Selecciona tipo"}),(0,o.jsx)("option",{value:"perro",children:"Perro"}),(0,o.jsx)("option",{value:"gato",children:"Gato"})]}),P&&(0,o.jsxs)("select",{value:N,onChange:e=>B(e.target.value),className:"w-full border px-4 py-2 rounded-lg",children:[(0,o.jsx)("option",{value:"",children:"Selecciona raza"}),("perro"===P?d:p).map(e=>(0,o.jsx)("option",{value:e,children:e},e))]})]}),(0,o.jsx)("button",{type:"submit",disabled:M,className:"w-full bg-[#5cae97] text-white font-semibold py-2 rounded-lg",children:M?"Guardando...":"Guardar cambios"})]}),(0,o.jsx)(u.default,{href:"/inicio",className:"mt-6 inline-block text-[#5cae97] hover:underline",children:"← Volver al inicio"})]})}},2141:function(e,a,r){"use strict";r.d(a,{O:function(){return o}});let o=(0,r(6580).eI)("https://cinsudwupbiqqizvqwij.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNpbnN1ZHd1cGJpcXFpenZxd2lqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0ODQ3MTIsImV4cCI6MjA2ODA2MDcxMn0.NL4RoZ3dPWllHaJfK37WtPtu-6NTNJ-DRJrs6MAY8E0")},1774:function(e,a,r){"use strict";var o=Object.defineProperty,t=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,i=(e,a,r)=>new Promise((o,t)=>{var l=e=>{try{i(r.next(e))}catch(e){t(e)}},n=e=>{try{i(r.throw(e))}catch(e){t(e)}},i=e=>e.done?o(e.value):Promise.resolve(e.value).then(l,n);i((r=r.apply(e,a)).next())}),s={};((e,a)=>{for(var r in a)o(e,r,{get:a[r],enumerable:!0})})(s,{SessionContextProvider:()=>p,useSession:()=>f,useSessionContext:()=>h,useSupabaseClient:()=>g,useUser:()=>m}),e.exports=((e,a,r,i)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let r of l(a))n.call(e,r)||void 0===r||o(e,r,{get:()=>a[r],enumerable:!(i=t(a,r))||i.enumerable});return e})(o({},"__esModule",{value:!0}),s);var u=r(2265),c=r(7437),d=(0,u.createContext)({isLoading:!0,session:null,error:null,supabaseClient:{}}),p=({supabaseClient:e,initialSession:a=null,children:r})=>{let[o,t]=(0,u.useState)(a),[l,n]=(0,u.useState)(!a),[s,p]=(0,u.useState)();(0,u.useEffect)(()=>{!o&&a&&t(a)},[o,a]),(0,u.useEffect)(()=>{let a=!0;return function(){i(this,null,function*(){let{data:{session:r},error:o}=yield e.auth.getSession();if(a){if(o){p(o),n(!1);return}t(r),n(!1)}})}(),()=>{a=!1}},[]),(0,u.useEffect)(()=>{let{data:{subscription:a}}=e.auth.onAuthStateChange((e,a)=>{a&&("SIGNED_IN"===e||"TOKEN_REFRESHED"===e||"USER_UPDATED"===e)&&t(a),"SIGNED_OUT"===e&&t(null)});return()=>{a.unsubscribe()}},[]);let h=(0,u.useMemo)(()=>l?{isLoading:!0,session:null,error:null,supabaseClient:e}:s?{isLoading:!1,session:null,error:s,supabaseClient:e}:{isLoading:!1,session:o,error:null,supabaseClient:e},[l,o,s]);return(0,c.jsx)(d.Provider,{value:h,children:r})},h=()=>{let e=(0,u.useContext)(d);if(void 0===e)throw Error("useSessionContext must be used within a SessionContextProvider.");return e};function g(){let e=(0,u.useContext)(d);if(void 0===e)throw Error("useSupabaseClient must be used within a SessionContextProvider.");return e.supabaseClient}var f=()=>{let e=(0,u.useContext)(d);if(void 0===e)throw Error("useSession must be used within a SessionContextProvider.");return e.session},m=()=>{var e,a;let r=(0,u.useContext)(d);if(void 0===r)throw Error("useUser must be used within a SessionContextProvider.");return null!=(a=null==(e=r.session)?void 0:e.user)?a:null}}},function(e){e.O(0,[648,580,859,971,117,744],function(){return e(e.s=4827)}),_N_E=e.O()}]);