(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[310],{2327:function(e,t,a){Promise.resolve().then(a.bind(a,8899))},8899:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var s=a(7437),n=a(2265),r=a(2141),i=a(3303),l=a(7648),o=a(3145),c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),u=(e,t)=>{let a=(0,n.forwardRef)((a,s)=>{let{color:r="currentColor",size:i=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:u="",children:x,...h}=a;return(0,n.createElement)("svg",{ref:s,...c,width:i,height:i,stroke:r,strokeWidth:o?24*Number(l)/Number(i):l,className:["lucide","lucide-".concat(d(e)),u].join(" "),...h},[...t.map(e=>{let[t,a]=e;return(0,n.createElement)(t,a)}),...Array.isArray(x)?x:[x]])});return a.displayName="".concat(e),a},x=u("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),h=u("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),m=u("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);function p(e){var t;let{anuncio:a,onDelete:n}=e;return(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-md hover:shadow-lg transition overflow-hidden border border-[#d3f3e6]",children:[(0,s.jsx)("div",{className:"aspect-square relative bg-gray-100",children:(0,s.jsx)(o.default,{src:(null===(t=a.imagenes)||void 0===t?void 0:t[0])||"/placeholder.jpg",alt:a.titulo,fill:!0,className:"object-cover"})}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-800 truncate",children:a.titulo}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[a.provincia," \xb7 ",a.tipo]}),(0,s.jsx)("span",{className:"inline-block mt-2 px-2 py-1 text-xs rounded-full font-medium ".concat("Reservado"===a.estado?"bg-yellow-200 text-yellow-800":"Vendido"===a.estado?"bg-red-200 text-red-800":"bg-[#9ee0c6] text-gray-800"),children:a.estado||"Publicado"}),(0,s.jsxs)("p",{className:"text-xs text-gray-400 mt-2",children:["Publicado el ",new Date(a.created_at).toLocaleDateString()]}),a.updated_at&&(0,s.jsxs)("p",{className:"text-xs text-gray-400",children:["Actualizado el ",new Date(a.updated_at).toLocaleDateString()]}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-4 text-sm text-[#2e7d61] font-medium",children:[(0,s.jsxs)(l.default,{href:"/anuncio/".concat(a.id),className:"flex items-center gap-1 hover:underline",children:[(0,s.jsx)(x,{className:"w-4 h-4"})," Ver"]}),(0,s.jsxs)(l.default,{href:"/editar-anuncio/".concat(a.id),className:"flex items-center gap-1 hover:underline",children:[(0,s.jsx)(h,{className:"w-4 h-4"})," Editar"]}),(0,s.jsxs)("button",{onClick:()=>n(a.id),className:"flex items-center gap-1 text-red-500 hover:underline",children:[(0,s.jsx)(m,{className:"w-4 h-4"})," Eliminar"]})]})]})]})}function v(){let{user:e}=function(){let[e,t]=(0,n.useState)(null),[a,s]=(0,n.useState)(!0),r=(0,n.useCallback)(async()=>{var e;s(!0);let{data:{session:a}}=await i.O.auth.getSession(),n=null==a?void 0:null===(e=a.user)||void 0===e?void 0:e.id;if(!n){t(null),s(!1);return}let{data:r,error:l}=await i.O.from("users").select("*").eq("id",n).single();l?(console.error("Error obteniendo usuario:",l.message),t(null)):t(r),s(!1)},[]);return(0,n.useEffect)(()=>{r()},[r]),{user:e,loading:a,updateUser:r}}(),[t,a]=(0,n.useState)([]),[l,o]=(0,n.useState)(!0),[c,d]=(0,n.useState)(""),[u,x]=(0,n.useState)(""),[h,m]=(0,n.useState)(""),[v,f]=(0,n.useState)("");(0,n.useEffect)(()=>{e&&(async()=>{let{data:t,error:s}=await r.O.from("anuncios").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});s?console.error(s):a(t),o(!1)})()},[e]);let j=async e=>{if(!confirm("\xbfEliminar este anuncio? Esta acci\xf3n no se puede deshacer."))return;let{error:t}=await r.O.from("anuncios").delete().eq("id",e);t?(alert("Error al eliminar el anuncio"),console.error(t)):a(t=>t.filter(t=>t.id!==e))},g=t.filter(e=>e.titulo.toLowerCase().includes(c.toLowerCase())&&(!u||e.tipo===u)&&(!h||e.provincia===h)&&(!v||e.estado===v));return l?(0,s.jsx)("p",{className:"text-center mt-10",children:"Cargando tus anuncios..."}):0===t.length?(0,s.jsx)("p",{className:"text-center mt-10",children:"No tienes ning\xfan anuncio publicado a\xfan."}):(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-center text-gray-800 mb-8",children:"Mis anuncios"}),(0,s.jsxs)("div",{className:"mb-6 flex flex-wrap gap-4 items-center justify-between",children:[(0,s.jsx)("input",{type:"text",placeholder:"Buscar por t\xedtulo...",value:c,onChange:e=>d(e.target.value),className:"border rounded-md p-2 w-full sm:w-56"}),(0,s.jsxs)("select",{value:u,onChange:e=>x(e.target.value),className:"border rounded-md p-2",children:[(0,s.jsx)("option",{value:"",children:"Tipo"}),(0,s.jsx)("option",{value:"perro",children:"Perro"}),(0,s.jsx)("option",{value:"gato",children:"Gato"})]}),(0,s.jsxs)("select",{value:h,onChange:e=>m(e.target.value),className:"border rounded-md p-2",children:[(0,s.jsx)("option",{value:"",children:"Provincia"}),(0,s.jsx)("option",{value:"Barcelona",children:"Barcelona"}),(0,s.jsx)("option",{value:"Madrid",children:"Madrid"})]}),(0,s.jsxs)("select",{value:v,onChange:e=>f(e.target.value),className:"border rounded-md p-2",children:[(0,s.jsx)("option",{value:"",children:"Estado"}),(0,s.jsx)("option",{value:"Publicado",children:"Publicado"}),(0,s.jsx)("option",{value:"Reservado",children:"Reservado"}),(0,s.jsx)("option",{value:"Vendido",children:"Vendido"})]})]}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(e=>(0,s.jsx)(p,{anuncio:e,onDelete:j},e.id))})]})}},2141:function(e,t,a){"use strict";a.d(t,{O:function(){return s}});let s=(0,a(6580).eI)("https://cinsudwupbiqqizvqwij.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNpbnN1ZHd1cGJpcXFpenZxd2lqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0ODQ3MTIsImV4cCI6MjA2ODA2MDcxMn0.NL4RoZ3dPWllHaJfK37WtPtu-6NTNJ-DRJrs6MAY8E0")},3303:function(e,t,a){"use strict";let s;a.d(t,{O:function(){return s}});var n=a(2990);window.__supabase__||(window.__supabase__=(0,n.createBrowserClient)("https://cinsudwupbiqqizvqwij.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNpbnN1ZHd1cGJpcXFpenZxd2lqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0ODQ3MTIsImV4cCI6MjA2ODA2MDcxMn0.NL4RoZ3dPWllHaJfK37WtPtu-6NTNJ-DRJrs6MAY8E0")),s=window.__supabase__}},function(e){e.O(0,[648,580,145,990,971,117,744],function(){return e(e.s=2327)}),_N_E=e.O()}]);