(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[196],{4590:function(e,a,r){Promise.resolve().then(r.bind(r,7489))},7489:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return u}});var t=r(7437),n=r(2265),l=r(1774),o=r(9376),i=r(2141),s=r(7648);function u(){let e=(0,l.useUser)();(0,o.useRouter)();let[a,r]=(0,n.useState)(null),[u,c]=(0,n.useState)(!0),[d,m]=(0,n.useState)(""),[h,p]=(0,n.useState)(""),[x,g]=(0,n.useState)(""),[f,b]=(0,n.useState)(""),[v,S]=(0,n.useState)(""),[C,j]=(0,n.useState)(""),[y,P]=(0,n.useState)(""),[N,w]=(0,n.useState)(""),[E,T]=(0,n.useState)(""),[I,B]=(0,n.useState)("Publicado"),[A,O]=(0,n.useState)(null),[R,D]=(0,n.useState)(""),k="perro"===d?["Affenpinscher","Akita Inu","Alaskan Malamute","American Bully","American Staffordshire Terrier","Basenji","Basset Hound","Beagle","Bearded Collie","Bedlington Terrier","Bich\xf3n Fris\xe9","Bich\xf3n Malt\xe9s","Border Collie","Boston Terrier","Boxer","Braco Alem\xe1n","Bull Terrier","Bulldog Franc\xe9s","Bulldog Ingl\xe9s","Cairn Terrier","Caniche (Poodle)","Carlino (Pug)","Chihuahua","Chow Chow","Cocker Spaniel Ingl\xe9s","Collie","D\xe1lmata","Dogo Alem\xe1n","Dogo Argentino","Doberman","Fox Terrier","Galgo Espa\xf1ol","Golden Retriever","Gran Dan\xe9s","Husky Siberiano","Jack Russell Terrier","Labrador Retriever","Lhasa Apso","Mast\xedn Espa\xf1ol","Papill\xf3n","Pastor Alem\xe1n","Pastor Australiano","Pastor Belga","Pequin\xe9s","Perro de Agua Espa\xf1ol","Perro Lobo Checoslovaco","Pitbull","Pointer","Pomerania","Rottweiler","Schnauzer Miniatura","Setter Irland\xe9s","Shar Pei","Shiba Inu","Shih Tzu","Staffordshire Bull Terrier","Teckel (Dachshund)","Terranova","Vizsla","Weimaraner","West Highland White Terrier","Whippet","Yorkshire Terrier"]:"gato"===d?["Ragdoll","Sphynx","Persa","Maine Coon","British Shorthair","Siam\xe9s","Bengal\xed","Azul Ruso","Abisinio","Ex\xf3tico de Pelo Corto","Bombay","Burm\xe9s","Himalayo","Korat","Manx","Oriental","Scottish Fold","Selkirk Rex","Somal\xed","Van Turco"]:[];(0,n.useEffect)(()=>{e&&(async()=>{let{data:a,error:t}=await i.O.from("profiles").select("nombre, username, afijo, nucleo_zoologico, is_criadero").eq("id",e.id).single();t||!a?(console.error("Error al obtener el perfil:",t),r(null)):r(a),c(!1)})()},[e]);let z=async r=>{if(r.preventDefault(),!A||0===A.length)return alert("Debes subir al menos una imagen.");let t=[];for(let e=0;e<A.length;e++){let a=A[e],r="anuncio-".concat(Date.now(),"-").concat(a.name),{error:n}=await i.O.storage.from("anuncios").upload(r,a);if(n)return alert("Error al subir imagen: ".concat(n.message));let{data:l}=i.O.storage.from("anuncios").getPublicUrl(r);if(!(null==l?void 0:l.publicUrl))return alert("Error al obtener la URL p\xfablica.");t.push(l.publicUrl)}let{error:n}=await i.O.from("anuncios").insert({titulo:f,descripcion:v,tipo:d,raza:h,provincia:x,cachorros:y,edad:N,entrega:E,precio:C,estado:I,imagenes:t,user_id:null==e?void 0:e.id,afijo:(null==a?void 0:a.afijo)||null,nucleo_zoologico:(null==a?void 0:a.nucleo_zoologico)||null});if(n)return alert("Hubo un error al guardar el anuncio.");D("✅ Tu anuncio ha sido publicado correctamente. \xa1Gracias por confiar en TuCriadero!")};return u?(0,t.jsx)("div",{className:"p-10 text-center text-[#5cae97]",children:"Cargando..."}):(null==a?void 0:a.is_criadero)?(0,t.jsxs)("main",{className:"min-h-screen bg-[#E8F8F2] px-4 py-10",children:[(0,t.jsx)("img",{src:"/logo-criador.png",alt:"TuCriadero logo",className:"w-16 h-16 mx-auto mb-6"}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-[#5cae97] mb-6 text-center",children:"Publicar un anuncio"}),R&&(0,t.jsx)("div",{className:"mb-6 p-4 bg-green-100 text-green-800 border border-green-300 rounded-lg text-center font-medium",children:R}),(0,t.jsxs)("form",{onSubmit:z,className:"max-w-2xl mx-auto bg-white p-6 rounded-xl shadow space-y-4",children:[(0,t.jsx)("input",{type:"text",placeholder:"T\xedtulo del anuncio",value:f,onChange:e=>b(e.target.value),className:"w-full px-4 py-3 border rounded-lg",required:!0}),(0,t.jsx)("textarea",{placeholder:"Descripci\xf3n",value:v,onChange:e=>S(e.target.value),className:"w-full px-4 py-3 border rounded-lg",required:!0}),(0,t.jsxs)("select",{value:d,onChange:e=>m(e.target.value),className:"w-full px-4 py-3 border rounded-lg",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Selecciona tipo"}),(0,t.jsx)("option",{value:"perro",children:"Perro"}),(0,t.jsx)("option",{value:"gato",children:"Gato"})]}),(0,t.jsxs)("select",{value:h,onChange:e=>p(e.target.value),className:"w-full px-4 py-3 border rounded-lg",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Selecciona la raza"}),k.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsxs)("select",{value:x,onChange:e=>g(e.target.value),className:"w-full px-4 py-3 border rounded-lg",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Selecciona provincia"}),["\xc1lava","Albacete","Alicante","Almer\xeda","Asturias","\xc1vila","Badajoz","Barcelona","Burgos","C\xe1ceres","C\xe1diz","Cantabria","Castell\xf3n","Ciudad Real","C\xf3rdoba","Cuenca","Gerona","Granada","Guadalajara","Guip\xfazcoa","Huelva","Huesca","Islas Baleares","Ja\xe9n","La Coru\xf1a","La Rioja","Las Palmas","Le\xf3n","L\xe9rida","Lugo","Madrid","M\xe1laga","Murcia","Navarra","Orense","Palencia","Pontevedra","Salamanca","Santa Cruz de Tenerife","Segovia","Sevilla","Soria","Tarragona","Teruel","Toledo","Valencia","Valladolid","Vizcaya","Zamora","Zaragoza"].map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"edad",className:"block text-sm font-medium text-gray-700 mb-1",children:"Edad (opcional)"}),(0,t.jsx)("input",{type:"text",id:"edad",name:"edad",placeholder:"Ej: 8 semanas, 2 meses, reci\xe9n nacidos...",value:N,onChange:e=>w(e.target.value),className:"w-full px-4 py-3 border rounded-lg text-gray-700"})]}),(0,t.jsxs)("select",{value:y,onChange:e=>P(e.target.value),className:"w-full px-4 py-3 border rounded-lg",required:!0,children:[(0,t.jsx)("option",{value:"",children:"N\xfamero de cachorros"}),[...Array(10)].map((e,a)=>(0,t.jsx)("option",{value:a+1,children:a+1},a+1))]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{htmlFor:"fechaEntrega",className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de entrega"}),(0,t.jsx)("input",{type:"date",id:"fechaEntrega",name:"fechaEntrega",value:E,onChange:e=>T(e.target.value),className:"w-full px-4 py-3 border rounded-lg text-gray-700",required:!0})]}),(0,t.jsx)("input",{type:"number",placeholder:"Precio (€)",value:C,onChange:e=>j(e.target.value),className:"w-full px-4 py-3 border rounded-lg",required:!0}),(0,t.jsx)("select",{value:I,onChange:e=>B(e.target.value),className:"w-full px-4 py-3 border rounded-lg",children:["Publicado","Reservado","Vendido","Archivado"].map(e=>(0,t.jsx)("option",{children:e},e))}),(0,t.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>O(e.target.files),className:"w-full",required:!0}),(0,t.jsx)("button",{type:"submit",className:"w-full bg-[#5cae97] hover:bg-[#4c9c85] text-white font-bold py-3 rounded-lg transition",children:"Publicar anuncio"})]}),(0,t.jsx)("div",{className:"flex justify-center mt-6",children:(0,t.jsx)(s.default,{href:"/inicio",className:"inline-block bg-[#e8f8f2] hover:bg-[#d2eee2] text-[#5cae97] font-medium px-6 py-2 rounded-full transition duration-200 shadow-sm",children:"← Volver al inicio"})})]}):(0,t.jsxs)("main",{className:"min-h-screen bg-[#E8F8F2] px-4 py-10 text-center",children:[(0,t.jsx)("img",{src:"/logo-criador.png",alt:"TuCriadero logo",className:"w-16 h-16 mx-auto mb-6"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-[#5cae97]",children:"Solo los criadores verificados pueden publicar anuncios."}),(0,t.jsxs)("p",{className:"mt-2 text-[#5cae97] text-sm max-w-md mx-auto",children:["Para publicar un anuncio, debes editar tu perfil y activar la opci\xf3n ",(0,t.jsx)("strong",{children:'"Soy criador"'}),". Ve a ",(0,t.jsx)(s.default,{href:"/editar-perfil",className:"underline text-[#4c9c85] hover:text-[#3a8773]",children:"Editar perfil"}),", marca la casilla correspondiente y guarda los cambios."]}),(0,t.jsx)(s.default,{href:"/inicio",className:"mt-6 inline-block text-[#5cae97] underline",children:"← Volver a inicio"})]})}},2141:function(e,a,r){"use strict";r.d(a,{O:function(){return t}});let t=(0,r(6580).eI)("https://cinsudwupbiqqizvqwij.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNpbnN1ZHd1cGJpcXFpenZxd2lqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0ODQ3MTIsImV4cCI6MjA2ODA2MDcxMn0.NL4RoZ3dPWllHaJfK37WtPtu-6NTNJ-DRJrs6MAY8E0")},1774:function(e,a,r){"use strict";var t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,i=(e,a,r)=>new Promise((t,n)=>{var l=e=>{try{i(r.next(e))}catch(e){n(e)}},o=e=>{try{i(r.throw(e))}catch(e){n(e)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(l,o);i((r=r.apply(e,a)).next())}),s={};((e,a)=>{for(var r in a)t(e,r,{get:a[r],enumerable:!0})})(s,{SessionContextProvider:()=>m,useSession:()=>x,useSessionContext:()=>h,useSupabaseClient:()=>p,useUser:()=>g}),e.exports=((e,a,r,i)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let r of l(a))o.call(e,r)||void 0===r||t(e,r,{get:()=>a[r],enumerable:!(i=n(a,r))||i.enumerable});return e})(t({},"__esModule",{value:!0}),s);var u=r(2265),c=r(7437),d=(0,u.createContext)({isLoading:!0,session:null,error:null,supabaseClient:{}}),m=({supabaseClient:e,initialSession:a=null,children:r})=>{let[t,n]=(0,u.useState)(a),[l,o]=(0,u.useState)(!a),[s,m]=(0,u.useState)();(0,u.useEffect)(()=>{!t&&a&&n(a)},[t,a]),(0,u.useEffect)(()=>{let a=!0;return function(){i(this,null,function*(){let{data:{session:r},error:t}=yield e.auth.getSession();if(a){if(t){m(t),o(!1);return}n(r),o(!1)}})}(),()=>{a=!1}},[]),(0,u.useEffect)(()=>{let{data:{subscription:a}}=e.auth.onAuthStateChange((e,a)=>{a&&("SIGNED_IN"===e||"TOKEN_REFRESHED"===e||"USER_UPDATED"===e)&&n(a),"SIGNED_OUT"===e&&n(null)});return()=>{a.unsubscribe()}},[]);let h=(0,u.useMemo)(()=>l?{isLoading:!0,session:null,error:null,supabaseClient:e}:s?{isLoading:!1,session:null,error:s,supabaseClient:e}:{isLoading:!1,session:t,error:null,supabaseClient:e},[l,t,s]);return(0,c.jsx)(d.Provider,{value:h,children:r})},h=()=>{let e=(0,u.useContext)(d);if(void 0===e)throw Error("useSessionContext must be used within a SessionContextProvider.");return e};function p(){let e=(0,u.useContext)(d);if(void 0===e)throw Error("useSupabaseClient must be used within a SessionContextProvider.");return e.supabaseClient}var x=()=>{let e=(0,u.useContext)(d);if(void 0===e)throw Error("useSession must be used within a SessionContextProvider.");return e.session},g=()=>{var e,a;let r=(0,u.useContext)(d);if(void 0===r)throw Error("useUser must be used within a SessionContextProvider.");return null!=(a=null==(e=r.session)?void 0:e.user)?a:null}},9376:function(e,a,r){"use strict";var t=r(5475);r.o(t,"useParams")&&r.d(a,{useParams:function(){return t.useParams}}),r.o(t,"useRouter")&&r.d(a,{useRouter:function(){return t.useRouter}}),r.o(t,"useSearchParams")&&r.d(a,{useSearchParams:function(){return t.useSearchParams}})}},function(e){e.O(0,[648,580,971,117,744],function(){return e(e.s=4590)}),_N_E=e.O()}]);